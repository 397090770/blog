<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Gradient descent for Logistic regression in octave</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Thoughts of geekperson">
    <link rel="canonical" href="http://www.madhukaraphatak.comblog.zinnianewsite.in/gradient-descent-for-logistic-regression-in-octave">
     <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="blog.zinnianewsite.in/css/main.css">
    <link rel="stylesheet" href="blog.zinnianewsite.in/css/app.css">    
</head>


    <body>

    <header >
  <div class="wrap">
    <a class="site-title" href="blog.zinnianewsite.in/">Madhukar's Blog</a>    
  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">
   <header class="post-header">
    <h1>Gradient descent for Logistic regression in octave</h1>
    <p class="meta">Feb 1, 2014</p>
    <div class="catagories">
    
         <a href="blog.zinnianewsite.in/categories/machine-learning"><span class="category">machine-learning</span></a>
    
    </div>
  </header> 

  <article class="post-content">
  <p>I am a huge fan of machine learning classes on <a href="http://www.ml-class.org">coursera</a>. They do a great job of explaining machine learning techniques with lots of hands on . If you are following the course or watching videos you will find this post useful.       </p>

<p>In the discussion of Logistic Regression,  exercise two, we use fminunc function rather than standard gradient descent for minimizing for theta. Exercise does not discuss how to use gradient descent for the same. If you use the code of gradient descent of linear  regression exercise you don’t get same values of theta . So you will be left wondering how to use gradient descent for logistic regression.  Even I also got stuck at same place and was able to figure it out after lot of trial and error. To save other’s pain I am sharing following code for the same.</p>

<p>Create a file called gradientDescent.m and paste the following code</p>

<div class="highlight"><pre><code class="octave"><span class="k">function</span><span class="w"> </span>[theta,cost] <span class="p">=</span><span class="w"> </span><span class="nf">gradientDescent</span><span class="p">(</span>X, y, theta, alpha, num_iters<span class="p">)</span><span class="w"></span>

<span class="c">%GRADIENTDESCENT Performs gradient descent to learn theta</span>

<span class="c">%   theta = GRADIENTDESENT(X, y, theta, alpha, num_iters) updates theta by</span>

<span class="c">%   taking num_iters gradient steps with learning rate alpha</span>



<span class="c">% Initialize some useful values</span>

<span class="n">m</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">);</span> <span class="c">% number of training examples</span>

<span class="n">J_history</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">num_iters</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>

<span class="n">theta_history</span> <span class="p">=</span> <span class="n">theta</span><span class="p">;</span>



<span class="k">for</span> <span class="n">iter</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">num_iters</span>

    <span class="n">h</span> <span class="p">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="n">theta</span><span class="p">);</span>

    <span class="n">grad</span> <span class="p">=</span> <span class="p">(</span><span class="n">X</span><span class="o">&#39;*</span><span class="p">(</span><span class="n">h</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="n">m</span><span class="p">;</span>

    <span class="n">theta</span> <span class="p">=</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">*</span><span class="n">grad</span><span class="p">;</span>               

<span class="k">end</span>

<span class="p">[</span><span class="n">cost</span><span class="p">,</span><span class="nb">gradient</span><span class="p">]</span> <span class="p">=</span> <span class="n">costFunction</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">);</span></code></pre></div>

<p>Other than the calculation of h, the other code is identical to the gradient descent of the logisitic regression.</p>

<p>To call gradient descent , add the following lines to ex2.m</p>

<div class="highlight"><pre><code class="octave"><span class="c">%%============= Part 4: Optimizing using Gradient Descent =============</span>

<span class="n">alpha</span> <span class="p">=</span> <span class="mf">0.0014</span><span class="p">;</span>

<span class="p">[</span><span class="n">theta</span><span class="p">,</span><span class="n">cost</span><span class="p">]=</span> <span class="n">gradientDescent</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span>
<span class="n">initial_theta</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="mi">2000000</span><span class="p">);</span>

<span class="c">% Print theta to screen</span>

<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;Cost at theta found by gradient Descent: %f\n&#39;</span><span class="p">,</span> <span class="n">cost</span><span class="p">);</span>

<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;theta: \n&#39;</span><span class="p">);</span>

<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39; %f \n&#39;</span><span class="p">,</span> <span class="n">theta</span><span class="p">);</span>



<span class="c">% Plot Boundary</span>

<span class="n">plotDecisionBoundary</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>



<span class="c">% Put some labels</span>

<span class="nb">hold</span> <span class="n">on</span><span class="p">;</span>

<span class="c">% Labels and Legend</span>

<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Exam 1 score&#39;</span><span class="p">)</span>

<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Exam 2 score&#39;</span><span class="p">)</span>



<span class="c">% Specified in plot order</span>

<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;Admitted&#39;</span><span class="p">,</span> <span class="s">&#39;Not admitted&#39;</span><span class="p">)</span>

<span class="nb">hold</span> <span class="n">off</span><span class="p">;</span>



<span class="nb">fprintf</span><span class="p">(</span><span class="s">&#39;\nProgram paused. Press enter to continue.\n&#39;</span><span class="p">);</span>

<span class="nb">pause</span><span class="p">;</span></code></pre></div>

<p>Now you should have gradient descent working for logistic regression.</p>


  </article>

</div>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">   
    <div class="footer-col-1 column">
      <ul>
        <li>
          <a href="https://github.com/phatak-dev">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">phatak-dev</span>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/madhukaraphatak">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
                c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
                c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
                C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
                c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
                c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
              </svg>
            </span>
            <span class="username">madhukaraphatak</span>
          </a>
        </li>
      </ul>
    </div>

    <div class="footer-col-3 column">
      <p class="text">Thoughts of geekperson</p>
    </div>

    <div style="float:right;">
      <a href="blog.zinnianewsite.in/feed.xml"><img src="blog.zinnianewsite.in/images/rss.png">
    </div>



  </div>

</footer>


    </body>
</html>